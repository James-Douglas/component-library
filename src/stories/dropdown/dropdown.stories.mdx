import { useState } from 'react';
import { Meta, Story, Preview, Props } from '@storybook/addon-docs/blocks';
import { withKnobs, text, boolean, number, select, array, object } from '@storybook/addon-knobs';
import styled, { css } from 'styled-components';
import Dropdown from '../../components/Dropdown/Dropdown.component';
import DropdownItem from '../../components/Dropdown/DropdownItem.component';
import Input from '../../components/Input/Input.component';
import Checkbox from '../../components/Checkbox/Checkbox.component';
import FluidContainer from '../../components/Grid/Container/FluidContainer.component';
import Row from '../../components/Grid/Row/Row.component';
import Column from '../../components/Grid/Column/Column.component';
import useIsDesktop from '../../hooks/useIsDesktop';

<Meta title="Components|Dropdown" component={Dropdown} />

# Dropdown

The Dropdown can be used to present users with a list of options from which they can choose. On mobile devices the
Manor Dropdown presents a full screen overlay of selectable options when the user interacts with it.

<Story name="Dropdown">
  {() => {
    const SvgAusFlag = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="35" viewBox="0 0 512 512">
        <path fill="#0052b4" d="M0 85.333h512V426.67H0z" />
        <g fill="#f0f0f0">
          <path d="M223.397 255.996c.273-.304.543-.609.813-.916-.27.308-.546.61-.82.916h.007zM189.217 297.923l10.958 22.913 24.747-5.718-11.083 22.853 19.9 15.781-24.776 5.585.069 25.398-19.815-15.89-19.814 15.89.069-25.398-24.776-5.585 19.9-15.781-11.083-22.853 24.746 5.718zM387.076 326.387l5.227 10.929 11.803-2.728-5.286 10.9 9.492 7.528-11.818 2.663.032 12.114-9.45-7.578-9.45 7.578.032-12.114-11.817-2.663 9.491-7.528-5.285-10.9 11.803 2.728zM338.453 210.448l5.227 10.93 11.803-2.729-5.286 10.901 9.491 7.528-11.817 2.663.032 12.115-9.45-7.58-9.451 7.58.033-12.115-11.818-2.663 9.491-7.528-5.284-10.901 11.802 2.729zM387.076 144.198l5.227 10.93 11.803-2.73-5.286 10.902 9.491 7.527-11.817 2.664.032 12.114-9.45-7.58-9.45 7.58.032-12.114-11.817-2.664 9.491-7.527-5.285-10.902 11.803 2.73zM429.547 193.886l5.227 10.929 11.802-2.728-5.284 10.9 9.491 7.527-11.818 2.664.033 12.114-9.451-7.578-9.45 7.578.032-12.114-11.817-2.664 9.491-7.527-5.286-10.9 11.803 2.728zM399.179 251.856l4.11 12.652h13.304l-10.763 7.82 4.112 12.652-10.763-7.819-10.765 7.819 4.112-12.652-10.763-7.82h13.304z" />
          <path d="M256 85.333v30.553l-45.167 25.099H256v59.359h-59.103L256 233.179v22.817h-26.68l-73.494-40.826v40.826h-55.652v-48.573l-87.43 48.573H0v-30.553l45.167-25.099H0v-59.359h59.103L0 108.139V85.333h26.68l73.494 40.827V85.333h55.652v48.573l87.43-48.573z" />
        </g>
        <path fill="#d80027" d="M144 85.33h-32v69.332H0v32h112v69.334h32v-69.334h112v-32H144z" />
        <path fill="#0052b4" d="M155.826 200.344L256 255.996v-15.737l-71.847-39.915z" />
        <path fill="#f0f0f0" d="M155.826 200.344L256 255.996v-15.737l-71.847-39.915z" />
        <g fill="#d80027"><path d="M155.826 200.344L256 255.996v-15.737l-71.847-39.915zM71.846 200.344L0 240.259v15.737l100.174-55.652z" /></g>
        <path fill="#0052b4" d="M100.174 140.982L0 85.33v15.737l71.847 39.915z" />
        <path fill="#f0f0f0" d="M100.174 140.982L0 85.33v15.737l71.847 39.915z" />
        <g fill="#d80027"><path d="M100.174 140.982L0 85.33v15.737l71.847 39.915zM184.154 140.982L256 101.067V85.33l-100.174 55.652z" /></g>
      </svg>
    );
    return (
      <FluidContainer>
        <Row>
          <Column>
            <div style={{ marginBottom: '40px', width: '100%' }}>
              <Dropdown
                id="input-one"
                label="Dropdown Label"
                tooltip={{ title: 'text area tooltip!' }}
                handleChange={(event, value) => { console.log(`selected: ${value}`); }}
                prefixContent={<SvgAusFlag />}
              >
                <DropdownItem value="Default Item - Title" />
                <DropdownItem value="First Item - Title" />
                <DropdownItem value="Second Item - Title" />
                <DropdownItem value="Third Item - Title" />
              </Dropdown>
            </div>
          </Column>
        </Row>
      </FluidContainer>
    );
  }}
</Story>

## Behaviour
* Clicking/Tapping on the Dropdown causes the list of options to be displayed.
* The currently selected option has a tick icon displayed next to in the dropdown list.
* Selecting an item from the Dropdown list causes the list to be hidden and the input text to update to that of the
selected option.

#### Mobile specific
* On focus of the Dropdown, a modal is presented on an overlay with a list of the given options.
* When the modal displaying the options is displayed, tapping on the overlay will dismiss the modal and the current
selection will not update.
* When the modal displaying the options is displayed, tapping on an option will dismiss the modal and the current
selection will update to the selected option.

### Accessibility
* The Dropdown can be focused via the `Tab` key.
* When the Dropdown is focused, the `Up` and `Down` arrow keys can be used to traverse the list of options.
* When a list item is focused, the `Enter` key can be used to select it.
* When the Dropdown is focused, the `Escape` key will dismiss the list of options.

### Props (Dropdown)
<Props of={Dropdown} />

### Props (DropdownItem)
<Props of={DropdownItem} />

<Story name="Dropdown with props" decorators={[withKnobs]} parameters={{ docs: { disable: true } }}>
  {() => {
    const desktop = useIsDesktop();
    const componentPropsId = 'Component Props';
    const tooltipGroupId = 'Tooltip Props';
    const id = text('id', 'dropdown-demo', componentPropsId);
    const label = text('label', 'Example Dropdown', componentPropsId);
    const placeholder = text('placeholder', 'Please select a value', componentPropsId);
    const validationMessage = text('validationMessage', '', componentPropsId);
    const disabled = boolean('disabled', false, componentPropsId);
    const required = boolean('required', false, componentPropsId);
    const bordered = boolean('bordered', true, componentPropsId);
    const prefixContent = text('prefix', '', componentPropsId);
    const title = text('title', 'input tooltip', tooltipGroupId);
    const body = text('body', 'this is a tooltip for the input component', tooltipGroupId);
    const screenReaderLabel = text('screenReaderLabel', 'input screenReaderLabel', tooltipGroupId);
    return (
      <FluidContainer>
        <Row>
          <div style={{height: '300px'}}></div>
          <Column>
            <Dropdown
              id={id}
              label={label}
              placeholder={placeholder}
              required={required}
              disabled={disabled}
              bordered={bordered}
              prefixContent={prefixContent}
              validationMessage={validationMessage}
              tooltip={{
                title,
                body,
                screenReaderLabel,
              }}
              handleChange={(event, value) => { console.log(event, value); }}
              handleFocus={() => { console.log('dropdown was focused') }}
              handleBlur={() => { console.log('dropdown lost focus') }}
            >
              <DropdownItem value="Default Item - Title" />
              <DropdownItem value="First Item - Title" />
              <DropdownItem value="Second Item - Title" />
              <DropdownItem value="Third Item - Title" />
            </Dropdown>
          </Column>
        </Row>
      </FluidContainer>
    );
  }}
</Story>
